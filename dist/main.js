(()=>{"use strict";const t={enumerable:!0,configurable:!0};function e(e,s,o){t.get=function(){return this[s][o]},t.set=function(t){this[s][o]=t},Object.defineProperty(e,o,t)}class s{constructor(){this.id=o++,this.subs=[]}addSub(t){this.subs.push(t)}depend(){s.target&&s.target.addDep(this)}notify(){const t=this.subs.slice();for(let e=0,s=t.length;e<s;e++)t[e].update()}}let o=0;s.target=null;const n=[];function i(t,e){if("object"!=typeof t)return;let s;return Object.prototype.hasOwnProperty.call(t,"__ob__")&&t.__ob__ instanceof a?s=t.__ob__:"[object Object]"===Object.prototype.toString.call(t)&&(s=new a(t)),e&&s&&s.vmCount++,s}class a{constructor(t){var e;this.value=t,this.dep=new s,this.vmCount=0,e=t,Object.defineProperty(e,"__ob__",{value:this,enumerable:!1,writable:!0,configurable:!0}),this.walk(t)}walk(t){const e=Object.keys(t);for(let s=0;s<e.length;s++)c(t,e[s])}}function c(t,e,o,n){const a=new s,c=Object.getOwnPropertyDescriptor(t,e),l=c&&c.get,r=c&&c.set;l&&!r||2!==arguments.length||(o=t[e]);let h=!n&&i(o);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){const e=l?l.call(t):o;return s.target&&(a.addSub(s.target),h&&(console.log(h),h.dep.addSub(s.target))),e},set:function(e){const s=l?l.call(t):o;e===s||e!=e&&s!=s||(o=e,a.notify())}})}function l(t){const e=(t+"").charCodeAt(0);return 36===e||95===e}class r{constructor(t,e,s,o){this.vm=t,this.key=e,this.active=!0,this.value=this.get(),this.arg=o,this.cb=s}get(){let t;n.push(this),s.target=this;try{t=this.vm[this.key]}catch(t){console.error(t)}finally{n.pop(),s.target=n[n.length-1]}return t}update(){this.cb.call(this.vm,this.vm[this.key],void 0,this.arg)}run(){if(this.active){const t=this.get(),e=this.value;this.value=t,this.cb.call(this.vm,this.vm[this.key],e,this.arg)}}}class h{constructor(t,e){this.$el=document.querySelector(t),this.$vm=e,this.$el&&this.complie(this.$el)}complie(t){const e=t.childNodes;Array.from(e).forEach((t=>{if(1===t.nodeType){const e=t.attributes;Array.from(e).forEach((e=>{const s=e.name,o=e.value;if("m-model"===s){const e=this.$vm;t.onkeyup=function(s){e[o]=t.value},new r(this.$vm,o,this.updateInputValue,{node:t}),this.updateInputValue(this.$vm[o],"",{node:t})}else 0===s.indexOf("@")&&console.log(s.substring(1))}))}else if(3===t.nodeType&&/\{\{(.*)\}\}/.test(t.nodeValue)){var e=RegExp.$1.trim().split(".");const s=e.length,o=e.pop(),n=t.nodeValue,i={node:t,key:o,content:n};if(1===s)new r(this.$vm,o,this.updateNodeValue,i),this.updateNodeValue(this.$vm[o],"",i);else{e.unshift(this.$vm);const t=e.reduce(((t,e)=>t[e]));new r(t,o,this.updateNodeValue,i),this.updateNodeValue(t[o],"",i)}}t.childNodes&&t.childNodes.length>0&&this.complie(t)}))}updateNodeValue(t,e,s){let o=s.content;o=o.replace(/\{\{(.*)\}\}/,t),s.node.nodeValue=o}updateInputValue(t,e,s){s.node.value=t}}new class{constructor(t){this.$options=t,this._watcher=[],function(t){let s=t.$options.data;s=t._data="function"==typeof s?s.call(t,t):s||{};const o=Object.keys(s),n=t.$options.methods;let a=o.length;for(;a--;){const s=o[a];n&&Object.prototype.hasOwnProperty.call(n,s)&&console.error(`Method "${s}" has already been defined as a data property.`,t),l(s)||e(t,"_data",s)}i(s,!0)}(this),new h(this.$options.el,this)}}({el:"#app",data:{author:"maggic",age:25,num:0,obj:{color:"red",size:"small"}}})})();